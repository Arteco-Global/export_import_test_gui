<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Import / Export GUI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="header">
        <h1>Import / Export</h1>
        <p>GUI minimale per scaricare l'export o aggiornare un config.json.</p>
      </header>

      <section class="card">
        <h2>Base URL</h2>
        <div class="field">
          <label for="baseUrl">Base URL</label>
          <input id="baseUrl" type="text" placeholder="https://example.com"value="https://V05250217.lan.omniaweb.cloud" />
        </div>
        <div class="hint" id="baseUrlHint">Serve per la chiamata GET a /api/v2/export.</div>
      </section>

      <section class="card">
        <h2>Export</h2>
        <p>Scarica l'export da <span class="mono">/api/v2/export</span> e salvalo dove vuoi.</p>
        <button id="exportBtn" class="primary" disabled>Scarica export</button>
        <div class="status" id="exportStatus"></div>
      </section>

      <section class="card">
        <h2>Anteprima relazioni</h2>
        <p>Carica <span class="mono">config.json</span> e <span class="mono">mapping.json</span> per vedere le telecamere e i servizi associati.</p>
        <div class="field">
          <label for="previewConfigFile">config.json</label>
          <input id="previewConfigFile" type="file" accept="application/json" />
        </div>
        <div class="field">
          <label for="previewMappingFile">mapping.json</label>
          <input id="previewMappingFile" type="file" accept="application/json" />
        </div>
        <div class="preview">
          <div id="previewStatus" class="status"></div>
          <div id="previewList" class="preview-list">
            <div class="placeholder">Carica entrambi i file per vedere l'anteprima.</div>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Import</h2>
        <p>Carica il <span class="mono">config.json</span> e il mapping del vecchio server. Il mapping nuovo si ottiene dal server.</p>
        <div class="field">
          <label for="configFile">config.json (vecchio server)</label>
          <input id="configFile" type="file" accept="application/json" />
        </div>
        <div class="field">
          <label for="mappingOldFile">mapping.json (vecchio server)</label>
          <input id="mappingOldFile" type="file" accept="application/json" />
        </div>

        <button id="fetchMappingBtn" class="primary">Ottieni mapping attuale</button>

        <div class="associations">
          <h3>Associazioni servizi</h3>
          <div id="associationList" class="association-list">
            <div class="placeholder">Carica entrambi i mapping per vedere le associazioni.</div>
          </div>
        </div>

        <button id="importBtn" class="primary" disabled>Invia import</button>
        <div class="status" id="importStatus"></div>
      </section>
    </main>

    <script src="app.js"></script>
  </body>
</html>
